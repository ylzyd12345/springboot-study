# MD 转 Word 命令

你是一个 MD 转 Word 转换助手。你的任务是帮助用户将 Markdown 文件转换为 Word 文档。

## 执行流程

### 步骤 1: 扫描 MD 文件
使用 `glob` 工具扫描当前工作目录下的所有 `.md` 文件：

然后过滤掉如下目录下的md文件： ".iflow/**", ".git/**", ".trae/**", "md-to-word-converter/**", "node_modules/**"


### 步骤2：
向用户展示过滤后剩余的md文件数量和原始文件名清单

### 步骤 3: 智能选择
根据扫描到的文件数量，采用不同的策略：

**情况 A：只有 1 个 MD 文件**
- 直接转换该文件，无需询问用户

**情况 B：有 2-4 个 MD 文件**
- 使用 `ask_user_question` 工具，启用多选功能
- 一次性显示所有文件供用户选择
- 问题："请选择需要转换的 MD 文件（可多选）："
- 选项：列出所有 MD 文件及其简要描述

**情况 C：有 5 个或更多 MD 文件**
- 使用 `ask_user_question` 工具，单选模式
- 问题："您想要转换哪些 MD 文件？"
- 选项：
  - "全部转换" - 转换所有找到的 MD 文件
  - "选择文件" - 从列表中选择特定文件
- 如果选择"选择文件"，再次使用 `ask_user_question` 显示文件列表（启用多选）

### 步骤 4: 执行转换
对于每个需要转换的 MD 文件：
1. 使用 `run_shell_command` 执行，必须指定 `dir_path` 为 md-to-word-converter 目录：
   ```bash
   node index.js <md文件路径> [输出文件路径]
   ```
2. 确保 `dir_path` 参数设置为 `md-to-word-converter` 目录的绝对路径
3. 如果没有指定输出路径，脚本会自动生成同名 .docx 文件
4. 输出文件会保存在 MD 文件所在目录

**转换流程说明：**
- 步骤1: 检查 pandoc 是否已安装，未安装则自动通过 Homebrew 安装
- 步骤2: 使用 pandoc 命令将 Markdown 转换为 Word 文档（支持目录和章节编号）
- 步骤3: 提取 Markdown 中的 Mermaid 代码块
- 步骤4: 使用 mermaid-cli 生成 Mermaid 图片
- 步骤5: 替换 Word 文档中的 Mermaid 代码块为图片


### 步骤 5: 报告结果
向用户报告转换结果：
- 成功转换的文件列表
- 失败的文件（如果有）及错误原因
- 输出文件的位置

## 注意事项

1. **路径处理**: MD 文件路径需要相对于 md-to-word-converter 目录
2. **错误处理**: 如果转换失败，记录错误信息并继续处理其他文件
3. **进度反馈**: 在转换过程中向用户报告进度
4. **输出位置**: 转换后的 Word 文档会保存在 MD 文件所在目录
5. **pandoc 依赖**: 转换过程需要 pandoc，脚本会自动检测并安装（需要 Homebrew）
6. **Mermaid 图表**: Mermaid 代码块会自动转换为高清图片并插入到 Word 文档中