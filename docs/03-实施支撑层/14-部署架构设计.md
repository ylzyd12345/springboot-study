# Junmo Platform ÈÉ®ÁΩ≤Êû∂ÊûÑËÆæËÆ°

## üìã ÊñáÊ°£‰ø°ÊÅØ

| È°πÁõÆ | ÂÜÖÂÆπ |
|------|------|
| **ÊñáÊ°£ÂêçÁß∞** | Junmo Platform ÈÉ®ÁΩ≤Êû∂ÊûÑËÆæËÆ° |
| **ÁâàÊú¨Âè∑** | v1.0.0 |
| **ÂàõÂª∫Êó•Êúü** | 2025-12-24 |
| **‰ΩúËÄÖ** | DevOpsÊû∂ÊûÑÂ∏à |
| **ÂÆ°Ê†∏‰∫∫** | ËøêÁª¥ÁªèÁêÜ |
| **ÊâπÂáÜ‰∫∫** | ÊäÄÊúØÊÄªÁõë |

## üéØ ÈÉ®ÁΩ≤Êû∂ÊûÑÊ¶ÇËø∞

Junmo PlatformÈááÁî®ÂÆπÂô®ÂåñÈÉ®ÁΩ≤Êû∂ÊûÑÔºåÂü∫‰∫éDockerÂíåKubernetesÊûÑÂª∫‰∫ëÂéüÁîüÈÉ®ÁΩ≤‰ΩìÁ≥ª„ÄÇÊîØÊåÅÂ§öÁéØÂ¢ÉÈÉ®ÁΩ≤ÔºàÂºÄÂèë„ÄÅÊµãËØï„ÄÅÈ¢ÑÁîü‰∫ß„ÄÅÁîü‰∫ßÔºâÔºåÂÖ∑Â§áËá™Âä®ÂåñCI/CDÊµÅÊ∞¥Á∫ø„ÄÅÁõëÊéßÂëäË≠¶„ÄÅÊó•ÂøóÊî∂ÈõÜ„ÄÅÂ§á‰ªΩÊÅ¢Â§çÁ≠âÂÆåÊï¥ÁöÑËøêÁª¥ËÉΩÂäõ„ÄÇ

## üèóÔ∏è ÂÆπÂô®ÂåñÊû∂ÊûÑ

### 1. DockerÈïúÂÉèËÆæËÆ°

#### 1.1 Â§öÈò∂ÊÆµÊûÑÂª∫Dockerfile

```dockerfile
# Âü∫Á°ÄÈïúÂÉè - ÊûÑÂª∫Èò∂ÊÆµ
FROM eclipse-temurin:25-jdk-alpine AS builder
WORKDIR /app

# ÂÆâË£ÖÊûÑÂª∫‰æùËµñ
RUN apk add --no-cache curl

# Â§çÂà∂MavenÈÖçÁΩÆ
COPY pom.xml .
COPY .mvn .mvn
COPY mvnw .

# ‰∏ãËΩΩ‰æùËµñ
RUN ./mvnw dependency:go-offline -B

# Â§çÂà∂Ê∫ê‰ª£Á†Å
COPY src src

# ÊûÑÂª∫Â∫îÁî®
RUN ./mvnw clean package -DskipTests

# ËøêË°åÊó∂ÈïúÂÉè
FROM eclipse-temurin:25-jre-alpine

# ÂÆâË£ÖËøêË°åÊó∂‰æùËµñ
RUN apk add --no-cache \
    curl \
    dumb-init \
    && rm -rf /var/cache/apk/*

# ÂàõÂª∫Â∫îÁî®Áî®Êà∑
RUN addgroup -g 1001 spring && \
    adduser -u 1001 -G spring -s /bin/sh -D spring

# ËÆæÁΩÆÂ∑•‰ΩúÁõÆÂΩï
WORKDIR /app

# Â§çÂà∂ÊûÑÂª∫‰∫ßÁâ©
COPY --from=builder /app/target/Junmo Platform-*.jar app.jar

# ÂàõÂª∫Êó•ÂøóÁõÆÂΩï
RUN mkdir -p /app/logs && \
    chown -R spring:spring /app

# ÂàáÊç¢Âà∞Â∫îÁî®Áî®Êà∑
USER spring

# ÂÅ•Â∫∑Ê£ÄÊü•
HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/actuator/health || exit 1

# Êö¥Èú≤Á´ØÂè£
EXPOSE 8080

# ÂêØÂä®Â∫îÁî®
ENTRYPOINT ["dumb-init", "--"]
CMD ["java", "-XX:+UseContainerSupport", "-XX:MaxRAMPercentage=75.0", "-jar", "app.jar"]
```

#### 1.2 Docker ComposeÂºÄÂèëÁéØÂ¢É

```yaml
# docker-compose.dev.yml
version: '3.8'

services:
  # Â∫îÁî®ÊúçÂä°
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/Junmo Platform
      - SPRING_DATASOURCE_USERNAME=Junmo Platform
      - SPRING_DATASOURCE_PASSWORD=password
      - SPRING_REDIS_HOST=redis
      - SPRING_REDIS_PORT=6379
    depends_on:
      mysql:
        condition: service_healthy
      redis:
        condition: service_healthy
    volumes:
      - ./logs:/app/logs
    networks:
      - Junmo Platform-network

  # MySQLÊï∞ÊçÆÂ∫ì
  mysql:
    image: mysql:8.0.35
    environment:
      - MYSQL_ROOT_PASSWORD=rootpassword
      - MYSQL_DATABASE=Junmo Platform
      - MYSQL_USER=Junmo Platform
      - MYSQL_PASSWORD=password
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./docker/mysql/init.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - Junmo Platform-network

  # RedisÁºìÂ≠ò
  redis:
    image: redis:7.0.5-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - Junmo Platform-network

  # MongoDB
  mongodb:
    image: mongo:6.0.8
    ports:
      - "27017:27017"
    environment:
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=password
      - MONGO_INITDB_DATABASE=Junmo Platform
    volumes:
      - mongodb_data:/data/db
      - ./docker/mongodb/init.js:/docker-entrypoint-initdb.d/init.js
    healthcheck:
      test: ["CMD", "mongosh", "--eval", "db.adminCommand('ping')"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - Junmo Platform-network

  # Elasticsearch
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.8.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:9200/_cluster/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - Junmo Platform-network

  # RabbitMQ
  rabbitmq:
    image: rabbitmq:3.12-management-alpine
    environment:
      - RABBITMQ_DEFAULT_USER=Junmo Platform
      - RABBITMQ_DEFAULT_PASS=password
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
    healthcheck:
      test: ["CMD", "rabbitmq-diagnostics", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - Junmo Platform-network

  # NginxÂèçÂêë‰ª£ÁêÜ
  nginx:
    image: nginx:1.24-alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./docker/nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./docker/nginx/conf.d:/etc/nginx/conf.d
      - ./docker/ssl:/etc/nginx/ssl
    depends_on:
      - app
    networks:
      - Junmo Platform-network

volumes:
  mysql_data:
  redis_data:
  mongodb_data:
  elasticsearch_data:
  rabbitmq_data:

networks:
  Junmo Platform-network:
    driver: bridge
```

#### 1.3 Áîü‰∫ßÁéØÂ¢ÉDocker Compose

```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  # Â∫îÁî®ÊúçÂä° - Â§öÂÆû‰æã
  app:
    image: ${REGISTRY}/Junmo Platform:${VERSION}
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql-master:3306/Junmo Platform
      - SPRING_DATASOURCE_USERNAME=${DB_USERNAME}
      - SPRING_DATASOURCE_PASSWORD=${DB_PASSWORD}
      - SPRING_REDIS_HOST=redis-cluster
      - SPRING_REDIS_PORT=6379
      - JAVA_OPTS=-Xms1g -Xmx2g -XX:+UseG1GC
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '2.0'
          memory: 2G
        reservations:
          cpus: '1.0'
          memory: 1G
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    depends_on:
      - mysql-master
      - redis-cluster
    networks:
      - Junmo Platform-network

  # MySQL‰∏ªÂ∫ì
  mysql-master:
    image: mysql:8.0.35
    environment:
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
      - MYSQL_DATABASE=Junmo Platform
      - MYSQL_USER=${DB_USERNAME}
      - MYSQL_PASSWORD=${DB_PASSWORD}
    volumes:
      - mysql_master_data:/var/lib/mysql
      - ./docker/mysql/master.cnf:/etc/mysql/conf.d/master.cnf
    command: --server-id=1 --log-bin=mysql-bin --binlog-format=ROW
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 4G
        reservations:
          cpus: '1.0'
          memory: 2G
    networks:
      - Junmo Platform-network

  # MySQL‰ªéÂ∫ì
  mysql-slave:
    image: mysql:8.0.35
    environment:
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
      - MYSQL_DATABASE=Junmo Platform
      - MYSQL_USER=${DB_USERNAME}
      - MYSQL_PASSWORD=${DB_PASSWORD}
    volumes:
      - mysql_slave_data:/var/lib/mysql
      - ./docker/mysql/slave.cnf:/etc/mysql/conf.d/slave.cnf
    command: --server-id=2 --relay-log=relay-bin --read-only=1
    depends_on:
      - mysql-master
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 2G
        reservations:
          cpus: '0.5'
          memory: 1G
    networks:
      - Junmo Platform-network

  # RedisÈõÜÁæ§
  redis-cluster:
    image: redis:7.0.5-alpine
    command: redis-server --cluster-enabled yes --cluster-config-file nodes.conf
    deploy:
      replicas: 6
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 256M
    volumes:
      - redis_cluster_data:/data
    networks:
      - Junmo Platform-network

  # MongoDBÂâØÊú¨ÈõÜ
  mongodb-primary:
    image: mongo:6.0.8
    environment:
      - MONGO_INITDB_ROOT_USERNAME=${MONGO_ROOT_USERNAME}
      - MONGO_INITDB_ROOT_PASSWORD=${MONGO_ROOT_PASSWORD}
      - MONGO_INITDB_DATABASE=Junmo Platform
    volumes:
      - mongodb_primary_data:/data/db
      - ./docker/mongodb/primary.conf:/etc/mongod.conf
    command: mongod --replSet rs0 --config /etc/mongod.conf
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 2G
        reservations:
          cpus: '0.5'
          memory: 1G
    networks:
      - Junmo Platform-network

  # ElasticsearchÈõÜÁæ§
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.8.0
    environment:
      - cluster.name=Junmo Platform
      - node.name=elasticsearch-1
      - discovery.seed_hosts=elasticsearch-2,elasticsearch-3
      - cluster.initial_master_nodes=elasticsearch-1,elasticsearch-2,elasticsearch-3
      - xpack.security.enabled=true
      - "ES_JAVA_OPTS=-Xms2g -Xmx2g"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '2.0'
          memory: 4G
        reservations:
          cpus: '1.0'
          memory: 2G
    networks:
      - Junmo Platform-network

  # NginxË¥üËΩΩÂùáË°°Âô®
  nginx:
    image: nginx:1.24-alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./docker/nginx/nginx.prod.conf:/etc/nginx/nginx.conf
      - ./docker/nginx/conf.d:/etc/nginx/conf.d
      - ./docker/ssl:/etc/nginx/ssl
      - nginx_logs:/var/log/nginx
    depends_on:
      - app
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M
    networks:
      - Junmo Platform-network

volumes:
  mysql_master_data:
  mysql_slave_data:
  redis_cluster_data:
  mongodb_primary_data:
  elasticsearch_data:
  nginx_logs:

networks:
  Junmo Platform-network:
    driver: overlay
    attachable: true
```

## ‚ò∏Ô∏è KubernetesÈÉ®ÁΩ≤

### 1. KubernetesËµÑÊ∫êÂÆö‰πâ

#### 1.1 ÂëΩÂêçÁ©∫Èó¥ÂíåÈÖçÁΩÆ

```yaml
# namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: Junmo Platform
  labels:
    name: Junmo Platform
    environment: production

---
# configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: Junmo Platform-config
  namespace: Junmo Platform
data:
  application.yml: |
    spring:
      profiles:
        active: prod
      datasource:
        url: jdbc:mysql://mysql-service:3306/Junmo Platform
        username: ${DB_USERNAME}
        password: ${DB_PASSWORD}
        hikari:
          maximum-pool-size: 20
          minimum-idle: 5
      redis:
        host: redis-service
        port: 6379
      jpa:
        hibernate:
          ddl-auto: validate
    logging:
      level:
        com.junmo.Junmo Platform: INFO
        org.springframework.security: DEBUG
    management:
      endpoints:
        web:
          exposure:
            include: health,info,metrics,prometheus
      endpoint:
        health:
          show-details: always

---
# secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: Junmo Platform-secrets
  namespace: Junmo Platform
type: Opaque
data:
  db-username: c3ByaW5nNGRlbW8=  # Junmo Platform (base64)
  db-password: cGFzc3dvcmQ=      # password (base64)
  jwt-secret: bXlfc2VjcmV0X2tleQ==  # my_secret_key (base64)
```

#### 1.2 Â∫îÁî®ÈÉ®ÁΩ≤

```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: Junmo Platform-app
  namespace: Junmo Platform
  labels:
    app: Junmo Platform-app
    version: v1.0.0
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  selector:
    matchLabels:
      app: Junmo Platform-app
  template:
    metadata:
      labels:
        app: Junmo Platform-app
        version: v1.0.0
    spec:
      containers:
      - name: Junmo Platform-app
        image: registry.example.com/Junmo Platform:1.0.0
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
          name: http
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: Junmo Platform-secrets
              key: db-username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: Junmo Platform-secrets
              key: db-password
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: Junmo Platform-secrets
              key: jwt-secret
        volumeMounts:
        - name: config-volume
          mountPath: /app/config
        - name: logs-volume
          mountPath: /app/logs
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 10
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        lifecycle:
          preStop:
            exec:
              command: ["sh", "-c", "sleep 15"]
      volumes:
      - name: config-volume
        configMap:
          name: Junmo Platform-config
      - name: logs-volume
        emptyDir: {}
      imagePullSecrets:
      - name: registry-secret

---
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: Junmo Platform-service
  namespace: Junmo Platform
  labels:
    app: Junmo Platform-app
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8080
    protocol: TCP
    name: http
  selector:
    app: Junmo Platform-app

---
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: Junmo Platform-ingress
  namespace: Junmo Platform
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/rate-limit-window: "1m"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
spec:
  tls:
  - hosts:
    - Junmo Platform.example.com
    secretName: Junmo Platform-tls
  rules:
  - host: Junmo Platform.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: Junmo Platform-service
            port:
              number: 80
```

#### 1.3 Êï∞ÊçÆÂ∫ìÈÉ®ÁΩ≤

```yaml
# mysql-master.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: mysql-master
  namespace: Junmo Platform
spec:
  serviceName: mysql-master
  replicas: 1
  selector:
    matchLabels:
      app: mysql-master
  template:
    metadata:
      labels:
        app: mysql-master
    spec:
      containers:
      - name: mysql
        image: mysql:8.0.35
        env:
        - name: MYSQL_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mysql-secrets
              key: root-password
        - name: MYSQL_DATABASE
          value: Junmo Platform
        - name: MYSQL_USER
          valueFrom:
            secretKeyRef:
              name: mysql-secrets
              key: username
        - name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mysql-secrets
              key: password
        ports:
        - containerPort: 3306
        volumeMounts:
        - name: mysql-data
          mountPath: /var/lib/mysql
        - name: mysql-config
          mountPath: /etc/mysql/conf.d
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
      volumes:
      - name: mysql-config
        configMap:
          name: mysql-config
  volumeClaimTemplates:
  - metadata:
      name: mysql-data
    spec:
      accessModes: ["ReadWriteOnce"]
      storageClassName: fast-ssd
      resources:
        requests:
          storage: 100Gi

---
# mysql-master-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: mysql-master
  namespace: Junmo Platform
spec:
  selector:
    app: mysql-master
  ports:
  - port: 3306
    targetPort: 3306
  clusterIP: None

---
# redis-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: redis
  namespace: Junmo Platform
spec:
  replicas: 1
  selector:
    matchLabels:
      app: redis
  template:
    metadata:
      labels:
        app: redis
    spec:
      containers:
      - name: redis
        image: redis:7.0.5-alpine
        ports:
        - containerPort: 6379
        volumeMounts:
        - name: redis-data
          mountPath: /data
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
      volumes:
      - name: redis-data
        persistentVolumeClaim:
          claimName: redis-pvc

---
# redis-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: redis-service
  namespace: Junmo Platform
spec:
  selector:
    app: redis
  ports:
  - port: 6379
    targetPort: 6379
```

### 2. Ê∞¥Âπ≥Ëá™Âä®Êâ©Â±ï

#### 2.1 HPAÈÖçÁΩÆ

```yaml
# hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: Junmo Platform-hpa
  namespace: Junmo Platform
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: Junmo Platform-app
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  - type: Pods
    pods:
      metric:
        name: http_requests_per_second
      target:
        type: AverageValue
        averageValue: "1000"
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
      - type: Percent
        value: 100
        periodSeconds: 15
      - type: Pods
        value: 4
        periodSeconds: 15
      selectPolicy: Max
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 10
        periodSeconds: 60
      - type: Pods
        value: 2
        periodSeconds: 60
      selectPolicy: Min
```

#### 2.2 VPAÈÖçÁΩÆ

```yaml
# vpa.yaml
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: Junmo Platform-vpa
  namespace: Junmo Platform
spec:
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: Junmo Platform-app
  updatePolicy:
    updateMode: "Auto"
  resourcePolicy:
    containerPolicies:
    - containerName: Junmo Platform-app
      maxAllowed:
        cpu: 2
        memory: 4Gi
      minAllowed:
        cpu: 500m
        memory: 1Gi
```

## üîÑ CI/CDÊµÅÊ∞¥Á∫ø

### 1. GitHub ActionsÂ∑•‰ΩúÊµÅ

#### 1.1 ÊûÑÂª∫ÂíåÈÉ®ÁΩ≤ÊµÅÊ∞¥Á∫ø

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      mysql:
        image: mysql:8.0.35
        env:
          MYSQL_ROOT_PASSWORD: password
          MYSQL_DATABASE: Junmo Platform_test
        ports:
          - 3306:3306
        options: --health-cmd="mysqladmin ping" --health-interval=10s --health-timeout=5s --health-retries=3
      
      redis:
        image: redis:7.0.5
        ports:
          - 6379:6379
        options: --health-cmd="redis-cli ping" --health-interval=10s --health-timeout=5s --health-retries=3

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up JDK 25
      uses: actions/setup-java@v3
      with:
        java-version: '25'
        distribution: 'temurin'

    - name: Cache Maven packages
      uses: actions/cache@v3
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}

    - name: Run tests
      run: mvn clean test
      env:
        SPRING_DATASOURCE_URL: jdbc:mysql://localhost:3306/Junmo Platform_test
        SPRING_DATASOURCE_USERNAME: root
        SPRING_DATASOURCE_PASSWORD: password
        SPRING_REDIS_HOST: localhost
        SPRING_REDIS_PORT: 6379

    - name: Generate test report
      uses: dorny/test-reporter@v1
      if: success() || failure()
      with:
        name: Maven Tests
        path: target/surefire-reports/*.xml
        reporter: java-junit

    - name: Run integration tests
      run: mvn verify -P integration-tests
      env:
        SPRING_PROFILES_ACTIVE: test

    - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v3
      with:
        file: ./target/site/jacoco/jacoco.xml

  build:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/develop'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2

    - name: Log in to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ${{ env.REGISTRY }}
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}

    - name: Extract metadata
      id: meta
      uses: docker/metadata-action@v4
      with:
        images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}

    - name: Build and push Docker image
      uses: docker/build-push-action@v4
      with:
        context: .
        push: true
        tags: ${{ steps.meta.outputs.tags }}
        labels: ${{ steps.meta.outputs.labels }}
        cache-from: type=gha
        cache-to: type=gha,mode=max

  security-scan:
    needs: build
    runs-on: ubuntu-latest
    
    steps:
    - name: Run Trivy vulnerability scanner
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:main
        format: 'sarif'
        output: 'trivy-results.sarif'

    - name: Upload Trivy scan results to GitHub Security tab
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: 'trivy-results.sarif'

  deploy-staging:
    needs: [build, security-scan]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'
    environment: staging
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up kubectl
      uses: azure/setup-kubectl@v3
      with:
        version: 'v1.24.0'

    - name: Configure kubectl
      run: |
        echo "${{ secrets.KUBE_CONFIG_STAGING }}" | base64 -d > kubeconfig
        export KUBECONFIG=kubeconfig

    - name: Deploy to staging
      run: |
        kubectl set image deployment/Junmo Platform-app Junmo Platform-app=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:develop -n Junmo Platform-staging
        kubectl rollout status deployment/Junmo Platform-app -n Junmo Platform-staging

    - name: Run smoke tests
      run: |
        kubectl wait --for=condition=ready pod -l app=Junmo Platform-app -n Junmo Platform-staging --timeout=300s
        ./scripts/smoke-tests.sh https://staging.Junmo Platform.example.com

  deploy-production:
    needs: [build, security-scan]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    environment: production
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up kubectl
      uses: azure/setup-kubectl@v3
      with:
        version: 'v1.24.0'

    - name: Configure kubectl
      run: |
        echo "${{ secrets.KUBE_CONFIG_PROD }}" | base64 -d > kubeconfig
        export KUBECONFIG=kubeconfig

    - name: Deploy to production
      run: |
        # ËìùÁªøÈÉ®ÁΩ≤
        kubectl apply -f k8s/production/blue-green.yaml -n Junmo Platform
        kubectl rollout status deployment/Junmo Platform-app-green -n Junmo Platform
        
        # ÂÅ•Â∫∑Ê£ÄÊü•
        kubectl wait --for=condition=ready pod -l app=Junmo Platform-app,color=green -n Junmo Platform --timeout=600s
        
        # ÂàáÊç¢ÊµÅÈáè
        kubectl patch service Junmo Platform-service -n Junmo Platform -p '{"spec":{"selector":{"color":"green"}}}'
        
        # Ê∏ÖÁêÜÊóßÁâàÊú¨
        kubectl delete deployment Junmo Platform-app-blue -n Junmo Platform

    - name: Run production smoke tests
      run: |
        ./scripts/smoke-tests.sh https://Junmo Platform.example.com

    - name: Notify deployment success
      uses: 8398a7/action-slack@v3
      with:
        status: success
        channel: '#deployments'
        text: 'üöÄ Junmo Platform deployed to production successfully!'
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
```

### 2. ArgoCD GitOps

#### 2.1 ArgoCDÂ∫îÁî®ÈÖçÁΩÆ

```yaml
# argocd/application.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: Junmo Platform
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/your-org/Junmo Platform-k8s
    targetRevision: HEAD
    path: environments/production
  destination:
    server: https://kubernetes.default.svc
    namespace: Junmo Platform
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true
    retry:
      limit: 5
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m
  ignoreDifferences:
  - group: apps
    kind: Deployment
    jsonPointers:
    - /spec/replicas
```

#### 2.2 ÁéØÂ¢ÉÈÖçÁΩÆ

```yaml
# environments/production/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: Junmo Platform-app
  namespace: Junmo Platform
spec:
  replicas: 5
  template:
    spec:
      containers:
      - name: Junmo Platform-app
        image: registry.example.com/Junmo Platform:1.0.0
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        - name: JAVA_OPTS
          value: "-Xms2g -Xmx4g -XX:+UseG1GC"

---
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: Junmo Platform-hpa
  namespace: Junmo Platform
spec:
  minReplicas: 5
  maxReplicas: 20
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
```

## üìä ÁõëÊéßÂíåÊó•Âøó

### 1. ÁõëÊéß‰ΩìÁ≥ª

#### 1.1 PrometheusÈÖçÁΩÆ

```yaml
# prometheus-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-config
  namespace: monitoring
data:
  prometheus.yml: |
    global:
      scrape_interval: 15s
      evaluation_interval: 15s
    
    rule_files:
      - "/etc/prometheus/rules/*.yml"
    
    alerting:
      alertmanagers:
        - static_configs:
            - targets:
              - alertmanager:9093
    
    scrape_configs:
      - job_name: 'Junmo Platform'
        kubernetes_sd_configs:
          - role: endpoints
            namespaces:
              names:
                - Junmo Platform
        relabel_configs:
          - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_scrape]
            action: keep
            regex: true
          - source_labels: [__meta_kubernetes_service_annotation_prometheus_io_path]
            action: replace
            target_label: __metrics_path__
            regex: (.+)
          - source_labels: [__address__, __meta_kubernetes_service_annotation_prometheus_io_port]
            action: replace
            regex: ([^:]+)(?::\d+)?;(\d+)
            replacement: $1:$3
            target_label: __address__
      
      - job_name: 'kubernetes-nodes'
        kubernetes_sd_configs:
          - role: node
        relabel_configs:
          - action: labelmap
            regex: __meta_kubernetes_node_label_(.+)
      
      - job_name: 'kubernetes-pods'
        kubernetes_sd_configs:
          - role: pod
        relabel_configs:
          - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
            action: keep
            regex: true
          - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
            action: replace
            target_label: __metrics_path__
            regex: (.+)

  alert.yml: |
    groups:
    - name: Junmo Platform.rules
      rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High error rate detected"
          description: "Error rate is {{ $value }} errors per second"
      
      - alert: HighMemoryUsage
        expr: (container_memory_usage_bytes / container_spec_memory_limit_bytes) * 100 > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High memory usage"
          description: "Memory usage is above 80%"
      
      - alert: PodCrashLooping
        expr: rate(kube_pod_container_status_restarts_total[15m]) > 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Pod is crash looping"
          description: "Pod {{ $labels.pod }} is crash looping"
```

#### 1.2 Grafana‰ª™Ë°®Êùø

```json
{
  "dashboard": {
    "title": "Junmo Platform Application Dashboard",
    "panels": [
      {
        "title": "Request Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(http_requests_total[5m])",
            "legendFormat": "{{method}} {{uri}}"
          }
        ],
        "yAxes": [
          {
            "label": "Requests/sec"
          }
        ]
      },
      {
        "title": "Response Time",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))",
            "legendFormat": "95th percentile"
          },
          {
            "expr": "histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m]))",
            "legendFormat": "99th percentile"
          }
        ],
        "yAxes": [
          {
            "label": "Seconds"
          }
        ]
      },
      {
        "title": "Error Rate",
        "type": "singlestat",
        "targets": [
          {
            "expr": "rate(http_requests_total{status=~\"5..\"}[5m]) / rate(http_requests_total[5m]) * 100"
          }
        ],
        "valueMaps": [
          {
            "value": "null",
            "text": "N/A"
          }
        ],
        "thresholds": "1,5,10"
      },
      {
        "title": "JVM Memory",
        "type": "graph",
        "targets": [
          {
            "expr": "jvm_memory_used_bytes{area=\"heap\"} / jvm_memory_max_bytes{area=\"heap\"} * 100",
            "legendFormat": "Heap Usage"
          },
          {
            "expr": "jvm_memory_used_bytes{area=\"nonheap\"} / jvm_memory_max_bytes{area=\"nonheap\"} * 100",
            "legendFormat": "Non-Heap Usage"
          }
        ],
        "yAxes": [
          {
            "label": "Usage %",
            "max": 100
          }
        ]
      }
    ]
  }
}
```

### 2. Êó•ÂøóÊî∂ÈõÜ

#### 2.1 EFK StackÈÖçÁΩÆ

```yaml
# elasticsearch.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: elasticsearch
  namespace: logging
spec:
  serviceName: elasticsearch
  replicas: 3
  selector:
    matchLabels:
      app: elasticsearch
  template:
    metadata:
      labels:
        app: elasticsearch
    spec:
      containers:
      - name: elasticsearch
        image: docker.elastic.co/elasticsearch/elasticsearch:8.8.0
        env:
        - name: cluster.name
          value: "Junmo Platform-logs"
        - name: node.name
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: discovery.seed_hosts
          value: "elasticsearch-0.elasticsearch,elasticsearch-1.elasticsearch,elasticsearch-2.elasticsearch"
        - name: ES_JAVA_OPTS
          value: "-Xms1g -Xmx1g"
        ports:
        - containerPort: 9200
        - containerPort: 9300
        volumeMounts:
        - name: elasticsearch-data
          mountPath: /usr/share/elasticsearch/data
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
  volumeClaimTemplates:
  - metadata:
      name: elasticsearch-data
    spec:
      accessModes: ["ReadWriteOnce"]
      storageClassName: fast-ssd
      resources:
        requests:
          storage: 100Gi

---
# fluentd.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd
  namespace: logging
spec:
  selector:
    matchLabels:
      name: fluentd
  template:
    metadata:
      labels:
        name: fluentd
    spec:
      serviceAccount: fluentd
      serviceAccountName: fluentd
      tolerations:
      - key: node-role.kubernetes.io/master
        effect: NoSchedule
      containers:
      - name: fluentd
        image: fluent/fluentd-kubernetes-daemonset:v1-debian-elasticsearch
        env:
        - name: FLUENT_ELASTICSEARCH_HOST
          value: "elasticsearch.logging.svc.cluster.local"
        - name: FLUENT_ELASTICSEARCH_PORT
          value: "9200"
        - name: FLUENT_ELASTICSEARCH_SCHEME
          value: "http"
        - name: FLUENT_ELASTICSEARCH_USER
          value: "elastic"
        - name: FLUENT_ELASTICSEARCH_PASSWORD
          valueFrom:
            secretKeyRef:
              name: elasticsearch-secrets
              key: password
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
        - name: fluentd-config
          mountPath: /fluentd/etc
        resources:
          limits:
            memory: 512Mi
          requests:
            cpu: 100m
            memory: 200Mi
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers
      - name: fluentd-config
        configMap:
          name: fluentd-config
```

#### 2.2 Êó•ÂøóÈÖçÁΩÆ

```xml
<!-- logback-spring.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <springProfile name="prod">
        <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
            <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
                <providers>
                    <timestamp/>
                    <logLevel/>
                    <loggerName/>
                    <message/>
                    <mdc/>
                    <stackTrace/>
                </providers>
            </encoder>
        </appender>
        
        <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
            <file>/app/logs/Junmo Platform.log</file>
            <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                <fileNamePattern>/app/logs/Junmo Platform.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
                <maxFileSize>100MB</maxFileSize>
                <maxHistory>30</maxHistory>
                <totalSizeCap>3GB</totalSizeCap>
            </rollingPolicy>
            <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
                <providers>
                    <timestamp/>
                    <logLevel/>
                    <loggerName/>
                    <message/>
                    <mdc/>
                    <stackTrace/>
                </providers>
            </encoder>
        </appender>
        
        <root level="INFO">
            <appender-ref ref="STDOUT"/>
            <appender-ref ref="FILE"/>
        </root>
    </springProfile>
</configuration>
```

## üîí ÂÆâÂÖ®ÈÖçÁΩÆ

### 1. ÁΩëÁªúÂÆâÂÖ®

#### 1.1 ÁΩëÁªúÁ≠ñÁï•

```yaml
# network-policy.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: Junmo Platform-network-policy
  namespace: Junmo Platform
spec:
  podSelector:
    matchLabels:
      app: Junmo Platform-app
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: ingress-nginx
    ports:
    - protocol: TCP
      port: 8080
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: Junmo Platform
    ports:
    - protocol: TCP
      port: 3306
    - protocol: TCP
      port: 6379
    - protocol: TCP
      port: 27017
  - to: []
    ports:
    - protocol: TCP
      port: 53
    - protocol: UDP
      port: 53
    - protocol: TCP
      port: 443
```

#### 1.2 PodÂÆâÂÖ®Á≠ñÁï•

```yaml
# pod-security-policy.yaml
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: Junmo Platform-psp
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'
```

### 2. RBACÈÖçÁΩÆ

```yaml
# rbac.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: Junmo Platform-sa
  namespace: Junmo Platform

---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: Junmo Platform-role
  namespace: Junmo Platform
rules:
- apiGroups: [""]
  resources: ["pods", "services", "configmaps", "secrets"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: Junmo Platform-rolebinding
  namespace: Junmo Platform
subjects:
- kind: ServiceAccount
  name: Junmo Platform-sa
  namespace: Junmo Platform
roleRef:
  kind: Role
  name: Junmo Platform-role
  apiGroup: rbac.authorization.k8s.io
```

## üîÑ Â§á‰ªΩÂíåÊÅ¢Â§ç

### 1. Êï∞ÊçÆÂ§á‰ªΩÁ≠ñÁï•

#### 1.1 Ëá™Âä®ÂåñÂ§á‰ªΩËÑöÊú¨

```bash
#!/bin/bash
# backup.sh

set -e

# ÈÖçÁΩÆÂèòÈáè
BACKUP_DIR="/backups"
DATE=$(date +%Y%m%d_%H%M%S)
MYSQL_HOST="mysql-master"
MYSQL_USER="backup_user"
MYSQL_PASSWORD="${MYSQL_BACKUP_PASSWORD}"
REDIS_HOST="redis-service"
MONGODB_HOST="mongodb-primary"

# ÂàõÂª∫Â§á‰ªΩÁõÆÂΩï
mkdir -p "${BACKUP_DIR}/${DATE}"

# MySQLÂ§á‰ªΩ
echo "Starting MySQL backup..."
mysqldump -h "${MYSQL_HOST}" -u "${MYSQL_USER}" -p"${MYSQL_PASSWORD}" \
  --single-transaction \
  --routines \
  --triggers \
  Junmo Platform | gzip > "${BACKUP_DIR}/${DATE}/mysql_backup.sql.gz"

# RedisÂ§á‰ªΩ
echo "Starting Redis backup..."
redis-cli -h "${REDIS_HOST}" --rdb "${BACKUP_DIR}/${DATE}/redis_backup.rdb"

# MongoDBÂ§á‰ªΩ
echo "Starting MongoDB backup..."
mongodump --host "${MONGODB_HOST}" --username "${MONGO_BACKUP_USER}" \
  --password "${MONGO_BACKUP_PASSWORD}" --gzip \
  --out "${BACKUP_DIR}/${DATE}/mongodb_backup"

# ‰∏ä‰º†Âà∞‰∫ëÂ≠òÂÇ®
echo "Uploading backups to cloud storage..."
aws s3 sync "${BACKUP_DIR}/${DATE}" s3://Junmo Platform-backups/${DATE}/

# Ê∏ÖÁêÜÊú¨Âú∞Â§á‰ªΩÔºà‰øùÁïô7Â§©Ôºâ
find "${BACKUP_DIR}" -type d -mtime +7 -exec rm -rf {} +

echo "Backup completed: ${DATE}"
```

#### 1.2 KubernetesÂ§á‰ªΩCronJob

```yaml
# backup-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: database-backup
  namespace: Junmo Platform
spec:
  schedule: "0 2 * * *"  # ÊØèÂ§©ÂáåÊô®2ÁÇπ
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: backup
            image: registry.example.com/backup-tools:latest
            command:
            - /bin/bash
            - -c
            - |
              # MySQLÂ§á‰ªΩ
              mysqldump -h mysql-master -u backup_user -p${MYSQL_BACKUP_PASSWORD} \
                --single-transaction Junmo Platform | gzip > /backup/mysql_$(date +%Y%m%d_%H%M%S).sql.gz
              
              # RedisÂ§á‰ªΩ
              redis-cli -h redis-service --rdb /backup/redis_$(date +%Y%m%d_%H%M%S).rdb
              
              # MongoDBÂ§á‰ªΩ
              mongodump --host mongodb-primary --username ${MONGO_BACKUP_USER} \
                --password ${MONGO_BACKUP_PASSWORD} --gzip \
                --out /backup/mongodb_$(date +%Y%m%d_%H%M%S)
              
              # ‰∏ä‰º†Âà∞S3
              aws s3 sync /backup s3://Junmo Platform-backups/$(date +%Y%m%d)/
            env:
            - name: MYSQL_BACKUP_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: backup-secrets
                  key: mysql-password
            - name: MONGO_BACKUP_USER
              valueFrom:
                secretKeyRef:
                  name: backup-secrets
                  key: mongodb-user
            - name: MONGO_BACKUP_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: backup-secrets
                  key: mongodb-password
            - name: AWS_ACCESS_KEY_ID
              valueFrom:
                secretKeyRef:
                  name: aws-credentials
                  key: access-key-id
            - name: AWS_SECRET_ACCESS_KEY
              valueFrom:
                secretKeyRef:
                  name: aws-credentials
                  key: secret-access-key
            volumeMounts:
            - name: backup-storage
              mountPath: /backup
            resources:
              requests:
                memory: "512Mi"
                cpu: "200m"
              limits:
                memory: "1Gi"
                cpu: "500m"
          volumes:
          - name: backup-storage
            persistentVolumeClaim:
              claimName: backup-pvc
          restartPolicy: OnFailure
```

---

*Êú¨ÊñáÊ°£Êèê‰æõ‰∫ÜËØ¶ÁªÜÁöÑÈÉ®ÁΩ≤Êû∂ÊûÑËÆæËÆ°ÔºåÂåÖÊã¨ÂÆπÂô®Âåñ„ÄÅKubernetesÈÉ®ÁΩ≤„ÄÅCI/CDÊµÅÊ∞¥Á∫ø„ÄÅÁõëÊéßÊó•Âøó„ÄÅÂÆâÂÖ®ÈÖçÁΩÆÂíåÂ§á‰ªΩÊÅ¢Â§çÁöÑÂÖ∑‰ΩìÂÆûÁé∞Ôºå‰∏∫ËøêÁª¥Âõ¢ÈòüÊèê‰æõ‰∫ÜÂÆåÊï¥ÁöÑÈÉ®ÁΩ≤ÂíåËøêÁª¥ÊåáÂØº„ÄÇ*