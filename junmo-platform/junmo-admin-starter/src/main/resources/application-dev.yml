# 开发环境配置
spring:
  config:
    activate:
      on-profile: dev

  # 数据源配置（开发环境 - 动态数据源 + Druid）
  datasource:
    dynamic:
      primary: master
      strict: false
      datasource:
        master:
          url: ${DATASOURCE_MASTER_URL:jdbc:mysql://localhost:3306/junmo_platform_dev?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&serverTimezone=GMT%2B8&allowPublicKeyRetrieval=true}
          username: ${DATASOURCE_MASTER_USERNAME:root}
          password: ${DATASOURCE_MASTER_PASSWORD}
          driver-class-name: com.mysql.cj.jdbc.Driver
          druid:
            initial-size: 5
            min-idle: 5
            max-active: 20
            max-wait: 60000
            time-between-eviction-runs-millis: 60000
            min-evictable-idle-time-millis: 300000
            validation-query: SELECT 1
            test-while-idle: true
            test-on-borrow: false
            test-on-return: false
            pool-prepared-statements: true
            max-pool-prepared-statement-per-connection-size: 20
            filters: stat,wall,slf4j
            connection-properties: druid.stat.mergeSql=false;druid.stat.slowSqlMillis=2000
            web-stat-filter:
              enabled: true
              url-pattern: /*
              exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"
            stat-view-servlet:
              enabled: true
              url-pattern: /druid/*
              reset-enable: false
              login-username: ${DRUID_STAT_USERNAME}
              login-password: ${DRUID_STAT_PASSWORD}
        slave:
          url: ${DATASOURCE_SLAVE_URL:jdbc:mysql://localhost:3307/junmo_platform_dev?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&serverTimezone=GMT%2B8&allowPublicKeyRetrieval=true}
          username: ${DATASOURCE_SLAVE_USERNAME:root}
          password: ${DATASOURCE_SLAVE_PASSWORD}
          driver-class-name: com.mysql.cj.jdbc.Driver
          druid:
            initial-size: 5
            min-idle: 5
            max-active: 20
            max-wait: 60000
            time-between-eviction-runs-millis: 60000
            min-evictable-idle-time-millis: 300000
            validation-query: SELECT 1
            test-while-idle: true
            test-on-borrow: false
            test-on-return: false
            pool-prepared-statements: true
            max-pool-prepared-statement-per-connection-size: 20
            filters: stat,wall,slf4j
            connection-properties: druid.stat.mergeSql=false;druid.stat.slowSqlMillis=2000

  # Redis配置（开发环境 - Lettuce + Redisson）
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      database: ${REDIS_DATABASE:0}
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: -1ms
        timeout: 2000ms
    # Redisson 配置（开发环境）
    redisson:
      address: ${REDIS_ADDRESS:redis://localhost:6379}
      database: ${REDISSON_DATABASE:0}
      password: ${REDIS_PASSWORD:}
      timeout: 3000
      connection-pool:
        connection-pool-size: 64
        connection-minimum-idle-size: 10
        idle-connection-timeout: 10000
        subscription-connection-pool-size: 50
        subscription-connection-minimum-idle-size: 1
      threads:
        thread-pool-size: 16
        netty-threads: 32
      single-server-config:
        connection-idle-timeout: 10000
        subscription-connection-timeout: 5000
        monitor-lock-expiration: 30000
        subscription-connection-pool-size: 50
        subscription-connection-minimum-idle-size: 1
        connection-pool-size: 64
        connection-minimum-idle-size: 10
        keep-alive: true

  # Thymeleaf 配置（开发环境）
  thymeleaf:
    cache: false

# 日志配置（开发环境）
logging:
  level:
    root: debug
    com.junmo.platform: debug
    org.springframework.web: debug
    org.springframework.security: debug
  pattern:
    console: "%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr([%thread]){blue} %clr(%-5level){cyan} %clr([%X{traceId:-},%X{userId:-}]){magenta} %clr(%logger{50}){yellow} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId:-},%X{userId:-}] %logger{50} - %msg%n"
  file:
    name: ./logs/junmo-platform-admin-dev.log

# MyBatis-Plus配置（开发环境）
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    call-setters-on-nulls: true
    jdbc-type-for-null: 'null'
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      id-type: assign_id
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
      table-underline: true
  mapper-locations: classpath*:mapper/*.xml
  type-aliases-package: com.junmo.platform.core.entity

# 管理端点配置（开发环境）
management:
  endpoints:
    web:
      exposure:
        include: "health,info,metrics,prometheus"
  endpoint:
    health:
      show-details: always
    prometheus:
      enabled: true
  prometheus:
    metrics:
      export:
        enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
      environment: dev

# 服务器配置（开发环境）
server:
  port: 8080
  servlet:
    context-path: /
  tomcat:
    uri-encoding: UTF-8
    max-threads: 200
    min-spare-threads: 30
    connection-timeout: 20000

# 缓存配置（开发环境 - 和 prod 一致）
spring:
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterAccess=3600s

# 异步任务配置（开发环境）
spring:
  task:
    execution:
      pool:
        core-size: 5
        max-size: 20
        queue-capacity: 100
        keep-alive: 60s
        thread-name-prefix: async-task-
    scheduling:
      pool:
        size: 5
        thread-name-prefix: scheduled-task-

# RustFS 文件存储配置（开发环境）
rustfs:
  endpoint: ${RUSTFS_ENDPOINT:http://localhost:9000}
  access-key: ${RUSTFS_ACCESS_KEY:admin}
  secret-key: ${RUSTFS_SECRET_KEY:admin123}
  bucket-name: junmo-platform-dev
  region: us-east-1
  path-style-access: true
  max-file-size: 50
  max-request-size: 100

# KKFileView 文档预览配置（开发环境）
kkfileview:
  server-url: ${KKFILEVIEW_SERVER_URL:http://localhost:8012}
  preview-path: /onlinePreview
  use-cache: false
  cache-expire-time: 3600
  current-server-url: http://localhost:8080
  force-update-cache: true

# Seata 分布式事务配置（开发环境）
seata:
  enabled: true
  service:
    grouplist:
      default: localhost:8091

# MongoDB 配置（开发环境）
spring:
  data:
    mongodb:
      uri: ${MONGODB_URI:mongodb://localhost:27017/junmo_platform_dev}
      database: ${MONGODB_DATABASE:junmo_platform_dev}
      auto-index-creation: true
      auto-time-logs: true

# Elasticsearch 配置（开发环境）
elasticsearch:
  host: ${ELASTICSEARCH_HOST:localhost}
  port: ${ELASTICSEARCH_PORT:9200}
  username: ${ELASTICSEARCH_USERNAME:}
  password: ${ELASTICSEARCH_PASSWORD:}
  protocol: ${ELASTICSEARCH_PROTOCOL:http}
  ssl:
    enabled: ${ELASTICSEARCH_SSL_ENABLED:false}
  connection-timeout: ${ELASTICSEARCH_CONNECTION_TIMEOUT:5000}
  socket-timeout: ${ELASTICSEARCH_SOCKET_TIMEOUT:30000}

# Quartz 任务调度配置（开发环境）
quartz:
  enabled: true
  instance-name: QuartzScheduler
  instance-id: AUTO
  job-store:
    job-store-class: org.quartz.simpl.RAMJobStore
    driver-delegate-class: org.quartz.impl.jdbcjobstore.StdJDBCDelegate
    table-prefix: QRTZ_
    is-clustered: false
    cluster-checkin-interval: 20000
    use-properties: false
  thread-pool:
    thread-pool-class: org.quartz.simpl.SimpleThreadPool
    thread-count: 5
    thread-priority: 5
    inherit-context-class-loader-of-initializing-thread: true

# Sa-Token配置（开发环境）
sa-token:
  token-name: satoken
  timeout: 2592000
  active-timeout: -1
  is-concurrent: true
  is-share: true
  token-style: uuid
  is-log: true
  is-read-cookie: false
  is-read-header: true
  token-prefix: Bearer
  alone-redis:
    database: 1
    host: localhost
    port: 6379
    password: ${SA_TOKEN_ALONE_REDIS_PASSWORD:}
    timeout: 10s

# Neo4j 图数据库配置（开发环境）
spring:
  data:
    neo4j:
      uri: ${NEO4J_URI:bolt://localhost:7687}
      authentication:
        username: ${NEO4J_USERNAME:neo4j}
        password: ${NEO4J_PASSWORD:password}
      database: ${NEO4J_DATABASE:neo4j}

# InfluxDB3 时序数据库配置（开发环境）
influxdb:
  url: ${INFLUXDB_URL:http://localhost:8181}
  token: ${INFLUXDB_TOKEN:}
  database: ${INFLUXDB_DATABASE:junmo_platform_dev}
  connectTimeout: 10000
  writeTimeout: 10000
  readTimeout: 10000
  logLevel: INFO